import React, { useState } from 'react';
import { Link } from 'react-router-dom';

const VulnerabilityList = ({ vulnerabilities }) => {
  const [filter, setFilter] = useState('All');
  const [search, setSearch] = useState('');

  const handleFilterChange = (e) => setFilter(e.target.value);
  const handleSearchChange = (e) => setSearch(e.target.value);

  let filteredVulnerabilities = vulnerabilities.filter((vuln) => {
    if (filter === 'All') return true;
    return vuln.severity === filter;
  });

  if (search.trim() !== '') {
    filteredVulnerabilities = filteredVulnerabilities.filter((vuln) =>
      vuln.title.toLowerCase().includes(search.toLowerCase())
    );
  }

  return (
    <div className="mt-5">
      <h2 className="mb-3">Vulnerabilities</h2>
      <div className="mb-4 d-flex flex-wrap align-items-center">
        <div className="me-3 mb-2">
          <input
            type="text"
            placeholder="Search vulnerabilities..."
            value={search}
            onChange={handleSearchChange}
            className="form-control"
          />
        </div>
        <div className="mb-2">
          <select
            value={filter}
            onChange={handleFilterChange}
            className="form-select"
          >
            <option value="All">All</option>
            <option value="High">High</option>
            <option value="Moderate">Moderate</option>
            <option value="Low">Low</option>
          </select>
        </div>
      </div>
      {filteredVulnerabilities.length === 0 ? (
        <p className="text-muted">No vulnerabilities found.</p>
      ) : (
        <ul className="list-group">
          {filteredVulnerabilities.map((vuln) => (
            <li key={vuln.id} className="list-group-item">
              <Link to={`/vulnerability/${vuln.id}`} className="text-decoration-none">
                {vuln.title}{' '}
                <span className={`badge ${vuln.severity === 'High' ? 'bg-danger' : vuln.severity === 'Moderate' ? 'bg-warning' : 'bg-success'}`}>
                  {vuln.severity}
                </span>
              </Link>
            </li>
          ))}
        </ul>
      )}
    </div>
  );
};

export default VulnerabilityList;
